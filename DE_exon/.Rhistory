setwd("/Users/pjt6/Documents/RNAseq_workshop/DE_exon")
getwd()
library("DEXSeq")
inDir = '/Users/pjt6/Documents/RNAseq_workshop/DE_exon'
countFiles = list.files(inDir, pattern=".exon.counts$", full.names=TRUE)
basename(countFiles)
countFiles
inDir = '/Users/pjt6/Documents/RNAseq_workshop/DE_exon'
countFiles = list.files(inDir, pattern=".exon.counts$", full.names=TRUE)
basename(countFiles)
countFiles = list.files(inDir, pattern=".exon.counts", full.names=TRUE)
basename(countFiles)
getwd()
countFiles = list.files(inDir, pattern=".exon.counts$", full.names=TRUE)
basename(countFiles)
countFiles = list.files(inDir, pattern=".exon.counts", full.names=TRUE)
basename(countFiles)
library(edgeR)
setwd("C:/Users/debca/Desktop/RNAseq_lecture_workshop/DE_gene/two_bio_reps")
setwd("C:/Users/pjt6/Desktop/RNAseq_lecture_workshop/DE_gene/two_bio_reps")
getwd()
data <- read.delim("TableOfCounts.txt", header=T, row.names=1)
group <- factor(c(1,1,2,2))
head(data)
rnaseqMatrix <- DGEList(counts=data, group=group)
head(rnaseqMatrix)
keep <- filterByExpr(rnaseqMatrix)
rnaseqMatrix <- rnaseqMatrix[keep,,keep.lib.sizes=FALSE]
table(keep)
rnaseqMatrix <- calcNormFactors(rnaseqMatrix)
rnaseqMatrix$samples$eff.lib.size = rnaseqMatrix$samples$lib.size * rnaseqMatrix$samples$norm.factors
write.table(rnaseqMatrix$samples, file="example.matrix.TMM_info.txt", quote=F, sep="\t", row.names=F)
rnaseqMatrix$samples
design <- model.matrix(~group)
rnaseqMatrix <- estimateDisp(rnaseqMatrix,design)
fit <- glmQLFit(rnaseqMatrix, design)
plotQLDisp(fit)
rnaseqMatrix$common.dispersion
fit
qlf <- glmQLFTest(fit,coef=2)
topTags(qlf)
tTags = topTags(qlf,n=NULL)
result_table = tTags$table
result_table = data.frame(sampleA="cherry", sampleB="gallium", result_table)
result_table <- result_table[order(result_table$logFC),]
write.table(result_table, file='M.cerasi_cherry_vs_gallium.GLM.edgeR.DE_results', sep='	', quote=F, row.names=T)
write.table(rnaseqMatrix, file='M.cerasi_cherry_vs_gallium.GLM.edgeR.count_matrix', sep='	', quote=F, row.names=T)
library(edgeR)
setwd("C:/Users/pjt6/Documents/RNAseq_lecture_workshop/DE_gene/three_bio_reps")
getwd()
dir()
data <- read.delim("Mcerasi.genes.counts.matrix", header=T, row.names=1)
head(head)
head(data)
group <- factor(c(1,1,1,2,2,2))
rnaseqMatrix <- DGEList(counts=data, group=group)
head(rnaseqMatrix)
keep <- filterByExpr(rnaseqMatrix)
rnaseqMatrix <- rnaseqMatrix[keep,,keep.lib.sizes=FALSE]
table(keep)
rnaseqMatrix <- calcNormFactors(rnaseqMatrix)
rnaseqMatrix$samples$eff.lib.size = rnaseqMatrix$samples$lib.size * rnaseqMatrix$samples$norm.factors
write.table(rnaseqMatrix$samples, file="example.matrix.TMM_info.txt", quote=F, sep="\t", row.names=F)
rnaseqMatrix$samples
design <- model.matrix(~group)
rnaseqMatrix <- estimateDisp(rnaseqMatrix,design)
fit <- glmQLFit(rnaseqMatrix, design)
rnaseqMatrix$common.dispersion
qlf <- glmQLFTest(fit,coef=2)
topTags(qlf)
tTags = topTags(qlf,n=NULL)
result_table = tTags$table
result_table = data.frame(sampleA="cherry", sampleB="gallium", result_table)
result_table <- result_table[order(result_table$logFC),]
write.table(result_table, file='M.cerasi_cherry_vs_gallium.GLM.edgeR.DE_results', sep='	', quote=F, row.names=T)
write.table(rnaseqMatrix, file='M.cerasi_cherry_vs_gallium.GLM.edgeR.count_matrix', sep='	', quote=F, row.names=T)
setwd("/Users/pjt6/Documents/RNAseq_workshop/DE_exon")
setwd("/Users/pjt6/Documents/RNAseq_workshop/DE_exon")
getwd()
library("DEXSeq")
inDir = '/Users/pjt6/Documents/RNAseq_workshop/DE_exon'
countFiles = list.files(inDir, pattern=".exon.counts$", full.names=TRUE)
basename(countFiles)
